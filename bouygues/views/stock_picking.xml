<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="bouygues_stock_picking_2_form_view" model="ir.ui.view">
            <field name="name">bouygues.stock.picking.2.form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                <xpath expr="//form" position="attributes">
                    <attribute name="duplicate">0</attribute>
                </xpath>
                <xpath expr="//field[@name='move_ids_without_package']//tree//field[@name='product_id']" position="before">
                    <field name="line_sequence"/>
                </xpath>
                <xpath expr="//field[@name='location_dest_id']" position="after">
                    <field name="has_group_wms_admin" invisible="1"/>
                    <field name="wms_exported" attrs="{'readonly': [('has_group_wms_admin', '=', False)]}"/>
                    <field name="export_filename"/>
                    <field name="import_filename"/>
                    <field name="partner_shipping_id" attrs="{'invisible': [('is_pick', '=', False), ('is_out', '=', False)]}"/>
                    <field name="shipping_name" attrs="{'invisible': [('partner_shipping_id', '=', False)]}"/>
                    <field name="shipping_street" attrs="{'invisible': [('partner_shipping_id', '=', False)]}"/>
                    <field name="shipping_zip" attrs="{'invisible': [('partner_shipping_id', '=', False)]}"/>
                    <field name="shipping_city" attrs="{'invisible': [('partner_shipping_id', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name='move_ids_without_package']//tree//field[@name='product_id']" position="after">
                    <field name="return_lots" attrs="{'column_invisible': [('parent.is_return', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name='move_ids_without_package']//tree//field[@name='product_id']" position="attributes">
                    <attribute name="options">{'no_create_edit': True}</attribute>
                </xpath>
                <xpath expr="//field[@name='origin']" position="after">
                    <field name="package_type_ids">
                        <tree editable="bottom">
                            <field name="package_type_id"/>
                            <field name="number"/>
                            <field name="weight"/>
                            <field name="location"/>
                        </tree>
                    </field>
                    <field name="dropship_note" string="SO Note" attrs="{'invisible': [('is_out', '!=', True)]}"/>
                    <field name="transporter_id" domain="['|', ('industry_name','ilike', '49.41'), ('industry_name','ilike', '52.')]" options="{'no_create_edit': True}"/>
                    <field name="preparator_id" domain="[('ref','=', 'PrÃ©parateur')]" attrs="{'readonly': [('is_pick', '!=', True)]}"/>
                    <field name="is_return" invisible="1"/>
                </xpath>
                <xpath expr="//page[@name='extra']//field[@name='company_id']" position="after">
                    <field name="picking_contact_id" attrs="{'invisible': [('picking_contact_id', '=', False)]}"/>
                    <field name="contact_phone" widget="phone" attrs="{'invisible': [('contact_phone', '=', False)]}"/>
                    <field name="contact_mobile" widget="phone" attrs="{'invisible': [('contact_mobile', '=', False)]}"/>
                    <field name="purchase_picking_contact_id" attrs="{'invisible': [('picking_contact_id', '=', True)]}"/>
                    <field name="purchase_contact_phone" widget="phone" attrs="{'invisible': [('purchase_contact_phone', '=', False)]}"/>
                    <field name="purchase_contact_mobile" widget="phone" attrs="{'invisible': [('purchase_contact_mobile', '=', False)]}"/>
                    <field name="purchase_contact_mail" widget="email" attrs="{'invisible': [('purchase_contact_mail', '=', False)]}"/>
                    <field name="purchase_id"/>
                </xpath>
                <xpath expr="//page[@name='note']" position="before">
                    <page name="warehouse_page" string="Warehouse Information">
                        <group>
                            <field name="warehouse_text_printed"/>
                            <field name="ditrl_text"/>
                            <field name="dichm_text"/>
                            <field name="paqtl_text"/>
                            <field name="locd_text"/>
                        </group>
                    </page>
                    <page name="sale_order_note" string="Sale Order Note" attrs="{'invisible': [('is_pick', '!=', True)]}">
                        <group>
                            <field name="dropship_note"/>
                        </group>
                    </page>
                    <page name="speed_wms_information" string="Speed WMS Information">
                        <group>
                            <group name="wms_1" attrs="{'invisible': [('is_receipt', '=', False),]}">
                                <field name="top_litige"/>
                                <field name="quality_code"/>
                                <field name="booking_ref"/>
                                <field name="speedwms_ref"/>
                            </group>
                            <group name="wms_2" attrs="{'invisible': [('is_pick', '=', False), ('is_out', '=', False)]}">
                                <field name="support_number"/>
                                <field name="weight"/>
                                <field name="tracking_number"/>
                            </group>
                        </group>
                    </page>
                </xpath>
                <xpath expr="//page[@name='extra']" position="before">
                    <page string="Undelivered" name="undelivered">
                        <field name="sale_order_line_ids">
                            <tree>
                                <field name="product_id" string="Product"/>
                                <field name="product_uom_qty" string="Demand"/>
                                <field name="qty_delivered" string="Delivered"/>
                                <field name="qty_to_deliver" string="To Deliver"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
                <xpath expr="//field[@name='scheduled_date']" position="after">
                    <field name="purchase_id" invisible="1"/>
                    <field name="real_delivery_date" attrs="{'invisible': ['|', ('purchase_id', '=', False), ('real_delivery_date', '=', False)]}"/>
                </xpath>
                <xpath expr="//button[@name='action_cancel']" position="after">
                    <field name="is_pick" invisible="1"/>
                    <field name="is_out" invisible="1"/>
                    <field name="is_receipt" invisible="1"/>
                    <field name="is_manual_locked" invisible="1"/>
                    <button string="Lock Pick" type="object" name="action_lock_picking" class="oe_highlight" attrs="{'invisible': ['|', ('is_pick', '=', False), ('is_manual_locked', '=', True)]}"/>
                    <button string="Unlock Pick" type="object" name="action_delock_picking" class="oe_highlight" attrs="{'invisible': ['|', ('is_pick', '=', False), ('is_manual_locked', '=', False)]}"/>
<!--                    <button string="ACTION DONE" type="object" name="action_done_picking" class="oe_highlight"/>-->
                </xpath>
                <xpath expr="//button[@name='action_cancel']" position="attributes">
                    <attribute name="groups">stock.group_stock_manager,bouygues.bouygues_supplier_sales_group,bouygues.bouygues_logistic_sales_group,bouygues.bouygues_manager_sales_group</attribute>
                </xpath>
                <xpath expr="//button[@name='button_validate'][1]" position="attributes">
                    <attribute name="groups">stock.group_stock_user,bouygues.bouygues_supplier_sales_group,bouygues.bouygues_logistic_sales_group,bouygues.bouygues_trade_sales_group,bouygues.bouygues_manager_sales_group</attribute>
                </xpath>
                <xpath expr="//button[@name='button_validate'][2]" position="attributes">
                    <attribute name="groups">stock.group_stock_user,bouygues.bouygues_supplier_sales_group,bouygues.bouygues_logistic_sales_group,bouygues.bouygues_trade_sales_group,bouygues.bouygues_manager_sales_group</attribute>
                </xpath>
                <xpath expr="//button[@name='do_print_picking']" position="after">
                    <button string="Print OUT" type="object" name="action_print_delivery_report" attrs="{'invisible': [('is_out', '!=', True)]}"/>
                    <button string="Print PICK" type="object" name="action_print_preparation_report" attrs="{'invisible': [('is_pick', '!=', True)]}"/>
                    <button string="Print IN" type="object" name="action_print_reception_report" attrs="{'invisible': [('is_receipt', '!=', True)]}"/>
                </xpath>
                <xpath expr="//field[@name='move_line_ids_without_package']" position="attributes">
                        <attribute name="attrs">{'readonly': ['|', '|', '|', ('show_operations', '=', False), ('state', '=', 'cancel'), '&amp;', ('state', '=', 'done'), ('is_locked', '=', True), '&amp;', ('state', 'in', ['waiting', 'confirmed']), ('is_out', '=', True)]}</attribute>
                </xpath>
                <xpath expr="//field[@name='origin']" position="after">
                    <field name="sale_id" string="Sale Order" attrs="{'invisible': [('sale_id', '=', False)]}" readonly="1"/>
                    <field name="purchase_id" string="Purchase Order" attrs="{'invisible': [('purchase_id', '=', False)]}" readonly="1"/>
                </xpath>
                <xpath expr="//button[@name='action_see_move_scrap']" position="before">
                    <button type="object"
                       name="action_view_sub_contracting_purchase_orders"
                       class="oe_stat_button"
                       icon="fa-shopping-cart"
                       attrs="{'invisible': ['|', ('subcontracting_po_count', '=', 0), '&amp;', ('is_out', '=', False), ('is_pick', '=', False)]}">
                       <field name="subcontracting_po_count" widget="statinfo" string="Purchase Order"/>
                    </button>
                </xpath>
                <xpath expr="//field[@name='contact_mobile']" position="after">
                    <field name="is_printed"/>
                </xpath>
            </field>
        </record>
        <record id="bouygues_stock_picking_list_view" model="ir.ui.view">
            <field name="name">bouygues.stock.picking.list</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.vpicktree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="is_printed"/>
                </xpath>
            </field>
        </record>
        <record id="bouygues_stock_picking_search_view" model="ir.ui.view">
            <field name="name">bouygues.stock.picking.search</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_internal_search"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='backorder']" position="after">
                    <separator/>
                    <filter name="updated_today" string="Updated today" domain="[('updated_today', '=', True)]"/>
                </xpath>
            </field>
        </record>
        <record model="ir.actions.server" id="action_create_return">
            <field name="name">Validate pickings (IN)</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="binding_model_id" ref="stock.model_stock_picking" />
            <field name="state">code</field>
            <field name="code">records.validate_pickings_in()</field>
        </record>
        <record id="bouygues_action_stock_picking_in_mail" model="ir.actions.act_window">
            <field name="name">Receptions</field>
            <field name="type">ir.actions.act_window</field>
            <field name="domain">[('picking_type_code', '=', 'incoming'), ('state', '=', 'assigned')]</field>
            <field name="res_model">stock.picking</field>
            <field name="context">{'search_default_my_transfers': 1}</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="stock.vpicktree"/>
        </record>

                <record model="ir.actions.server" id="action_export_reception_wms">
            <field name="name">Export Receptions (WMS)</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="binding_model_id" ref="stock.model_stock_picking" />
            <field name="state">code</field>
            <field name="code">records.export_reception_wms()</field>
        </record>

        <record model="ir.actions.server" id="action_export_preparation_wms">
            <field name="name">Export Preparations (WMS)</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="binding_model_id" ref="stock.model_stock_picking" />
            <field name="state">code</field>
            <field name="code">records.export_preparation_wms()</field>
        </record>

        <!-- Inventory -->
        <record id="stock.menu_stock_root" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('stock.group_stock_user'),
                ref('stock.group_stock_manager'),
                ref('bouygues.bouygues_supplier_sales_group'),
                ref('bouygues.bouygues_logistic_sales_group'),
                ref('bouygues.bouygues_trade_sales_group'),
                ref('bouygues.bouygues_manager_sales_group'),
            ])]"/>
        </record>
        <!-- Inventory/Operations/Transfers -->
        <record id="stock.all_picking" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('stock.group_stock_user'),
                ref('stock.group_stock_manager'),
                ref('bouygues.bouygues_supplier_sales_group'),
                ref('bouygues.bouygues_logistic_sales_group'),
                ref('bouygues.bouygues_trade_sales_group'),
                ref('bouygues.bouygues_manager_sales_group'),
            ])]"/>
        </record>
        <!-- Inventory/Operations/Run Scheduler -->
        <record id="stock.menu_procurement_compute" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_manager_sales_group'),
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Master Data/Reordering Rules -->
        <record id="stock.menu_reordering_rules_config" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_supplier_sales_group'),
                ref('bouygues.bouygues_trade_extended_sales_group'),
                ref('bouygues.bouygues_logistic_extended_sales_group'),
                ref('bouygues.bouygues_trade_sales_group'),
                ref('bouygues.bouygues_manager_sales_group'),
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Reporting -->
        <record id="stock.menu_warehouse_report" model="ir.ui.menu">
            <field name="groups_id" eval="[
                (4, ref('bouygues.bouygues_logistic_sales_group')),
                (4, ref('bouygues.bouygues_supplier_sales_group')),
                (4, ref('bouygues.bouygues_manager_sales_group')),
            ]"/>
        </record>
        <!-- Inventory/Configuration -->
        <record id="stock.menu_stock_config_settings" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_logistic_sales_group'),
                ref('stock.group_stock_manager'),
                ref('bouygues.bouygues_manager_sales_group'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Warehouse Management -->
        <record id="stock.menu_warehouse_config" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_logistic_sales_group'),
                ref('bouygues.bouygues_manager_sales_group'),
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Warehouse Management/Warehouses -->
        <record id="stock.menu_action_warehouse_form" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_manager_sales_group'),
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Warehouse Management/Rules -->
        <record id="stock.menu_action_rules_form" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Warehouse Management/Location -->
        <record id="stock.menu_action_location_form" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_logistic_extended_sales_group'),
                ref('bouygues.bouygues_manager_sales_group'),
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Warehouse Management/Routes -->
        <record id="stock.menu_routes_config" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Warehouse Management/Operations Types -->
        <record id="stock.menu_pickingtype" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Products -->
        <record id="stock.menu_product_in_config_stock" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('bouygues.bouygues_logistic_sales_group'),
                ref('bouygues.bouygues_manager_sales_group'),
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
        <!-- Inventory/Configuration/Units of Measures -->
        <record id="stock.product_uom_menu" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [
                ref('stock.group_stock_manager'),
            ])]"/>
        </record>
    </data>
</odoo>
